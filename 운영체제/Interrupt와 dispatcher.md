## Interrupt

- 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 현재 실행중인 작업을 중단하고 발생된 상황을 처리한 후 다시 실행중인 작업으로 복귀하는 것을 말한다
- 종류
  - 외부 인터럽트
    - 전원 이상 인터럽트 : 말그대로 정전, 파워 이상 등
    - 기계 착오 인터럽트 : CPU의 기능적인 오류
    - 외부 신호 인터럽트
      - 타이머에 의한 인터럽트 : 자원이 할당된 시간이 다 끝난 경우
      - 키보드로 인터럽트 키를 누른 경우 : ex)Ctr + Alt + Delete
      - 외부장치로부터 인터럽트 요청이 있는 경우
    - 입출력 인터럽트(I/O interrupt)
      - 입출력장치가 데이터 전송을 요구하거나 전송이 끝나 다음 동작이 수행되어야 할 경우
      - 입출력 데이터에 이상이 있는 경우
  - 내부 인터럽트
    - **잘못된 명령이나 잘못된 데이터를 사용**할때 발생
    - 프로그램 검사 인터럽트
      - Divisiton by Zero
      - Over/Underflow
      - Exception
  - 소프트웨어(SVC : SuperVisor Call)
    - 사용자가 프로그램을 실행시키거나 검사프로그램(Supervisor)을 호출하는 동작을 수행하는 경우
    - 소프트웨어 이용중 다른 프로세스를 실행시키면 시분할 처리를 위해 자원 할당 등의 동작이 수행
- 동작 순서
  1. 인터럽트 요청
  2. 프로그램 실행 중단 : 현재 실행중이던 Operation까지 수행
  3. 현재의 프로그램 상태 보존 : PC(Program Counter) 저장 : 다음번에 실행할 명령어 주소
         SR(Status Register) 저장 : 인터럽트 서비스 단계에서  SR값이 바뀔 수 있으므로 저장
  4. 인터럽트 처리루틴 실행 : 인터럽트를 요청한 장치를 식별
  5. 인터럽트 서비스 루틴 실행 : 인터럽티 원인 파악 후 실질적인 작업 수행
     서비스 루틴 실행중 우선순위가 더 높은 인터럽트가 발생하면 재귀적으로 1~5 수행
  6. 상태복구 : 인터럽트 발생 시 저장해든 PC다시 복구
  7. 중단된 프로그램 실행 재개 : PC의 값을 이용하여 이전에 수행중이던 프로그램을 재개
- 인터럽트 우선순위
  - 일반적으로 하드웨어 인터럽트 > 소프트웨어 인터럽트
        외부 인터럽트 > 내부 인터럽트
  - 전원 이상 > 기계 착오 > 외부 신호 > 입출력 > 명령어 > 프로그램 검사 > SVC

 

## dispatcher

사용자가 프로그램을 실행하면 프로세스가 생성되고 Ready상태가 된다(Ready Queue) 그 후 스케줄러가 Ready Queue에 있는 프로세스 중 하나를 프로세서(CPU)가 사용가능한 상태가 될 때 CPU를 할당해준다

이를 준비상태(Ready)에서 실행상태(Running)로 상태전이(State Transition)된다고 한다
이 과정일 디스패칭(dispatching)이라고 하고 디스패처(dispatcher)가 이 일을 수행한다

![운영체제 디스패처 이미지 검색결과](https://www.d.umn.edu/~gshute/os/images/ready.png)

이제 프로세스는 실행상태에서 CPU를 이용해 연산한 후 CPU를 자발적으로 반납하고 작업이 끝나지 않았으면 다시 준비상태로 들어간다. 운영체제는 다시 준비리스트의 첫번째에 있는 프로세스를 실행상태로 바꾸고 이 과정을 반복한다

운영체제는 프로세스가 CPU를 자발적으로 반납하지 않고 독점하는 경우를 방지하기 위해 **인터럽트 클럭**을 주기적으로 발생시켜 프로세스가 **특정 시간동안** 실행할 수 있도록 한다.
인터럽트 클럭이 발생되면 강제로 실행중인 프로세스의 CPU제어권을 운영체제에게 뺴앗기고 프로세스는 준비상태로 바뀐다.