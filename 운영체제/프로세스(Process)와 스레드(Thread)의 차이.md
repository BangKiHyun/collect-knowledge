# 프로세스(Process)와 스레드(Thread)의 차이

## 프로세스(Process)란?

프로세스란 **운영체제로부터 시스템 자원을 할당받는 작업의 단위**로 컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램을 의미합니다.

각각의 프로세스는 독립된 메모리 영역을 할당받습니다.(독립적인 개체)

</br >

### 할당받는 시스템 자원

프로세스는 운영체제로부터 다음과 같은 시스템 자원을 할당받습니다.

- CPU 시간
- 운영되기 위해 필요한 **주소 공간**
- Code, Data, Stack, Heap의 구조로 되어 있는 **독립된 메모리 영역**

</br >

### 프로세스 특징

- 프로세스는 **각각 독립된 메모리 영역(Code, Data, Stack, Heap)을 할당받습니다.**
- 기본적으로 **프로세스당 최소 1개의 스레드**(메인 스레드)를 갖고 있습니다.
- 각 프로세스는 각각의 별도의 주소 공간에서 실행되며, **한 프로세스는 다른 프로세스의 변수나 자료 구조에 접근할 수 없습니다.**
- 한 프로세스가 다른 프로세스의 자원에 접근하려면 프로세스 간의 통신을 사용해야 합니다.
  - ex) 파이프, 파일, 소켓 등을 이용한 통신 방법 전달

</br >

## 스레드(Thread)란?

**스레드는 프로세스 내에서 실행되는 여러 흐름의 단위를 의미합니다.**

즉, 프로세스가 할당받은 자원을 이용하는 실행의 단위입니다

</br >

### 스레드 특징

- **스레드는 프로세스 내에서 Stack만 따로 할당받고 나머지(Code, Data, Heap)영역은 공유합니다.**
- 스레드는 한 프로세스 내에서 동작되는 여러 실행의 흐름으로, 프로세스 내의 주소 공간이나 자원들을 같은 프로세스 내에 스레드끼리 공유하면서 실행됩니다.
- 같은 프로세스 안에 있는 여러 프로세스들은 같은 힙 공간을 공유합니다. 반면에 프로세스는 다른 프로세스의 메모리에 직접 접근할 수 습니다.
- 각각의 스레드는 별도의 레지스터와 스택을 갖고 있지만, 힙 메모리는 서로 읽고 쓸 수 있습니다.

</br >

### 자바 스레드(Java Thread)란?

- 일반 스레드와 거의 차이가 없으며, JVM가 운영체제의 역할을 합니다.
- 자바에는 프로세스가 존재하지 않고 스레드만 존재하며, 자바 스레드는 JVM에 의해 스케줄되는 실행 단위 코드 블록입니다.
- 자바에서 스레드 스케줄링은 전적으로 JVM이 관리합니다.
  - 스레드가 몇 개 존재하는지
  - 스레드로 실행되는 프로그램의 메모리 위치는 어디인지
  - 스레드의 상태와 우선순위는 얼마인지

즉, 개발자는 자바 스레드로 작동할 스레드 코드를 작성하고, 스레드 코드가 생명을 가지고 실행을 시작하도록 JVM에 요청하는 일 뿐입니다.

</br >

## 멀티 프로세스와 멀티 스레드

프로세스와 스레드의 기본적인 개념을 알아봤습니다. 이제 멀티 프로세스와 멀티 스레드에 대해 알아보겠습니다.

## 멀티 프로세스란?

멀티 프로세스는 하나의 응용프로그램을 여러 개의 프로세스로 구성하여 각 프로세스가 하나의 작업(task)을 처리하도록 하는 것을 의미합니다.

</br >

### 멀티 프로세스 장점

- 위에서 언급했듯이 프로세스는 독립된 메모리 영역을 할당받기 때문에 **여러 개의 프로세스중 하나에 문제가 발생해도 그 프로세스만 죽는 것 이상으로 다른 프로세스에 영향이 확산되지 않습니다.**

### 멀티 프로세스 단점

- Context Switching의 오버헤드
  - 프로세스는 각각의 독립된 메모리 영역을 할당 받았기 때문에 프로세스 사이에서 공유하는 메모리가 없습니다. 그렇기 때문에 Context Switching이 발생하면 캐시에 있는 모든 데이터를 리셋하고 다시 캐시 정보를 불러와야 합니다.
  - 즉, Context Switching 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되고 많은 시간이 소모되는 등의 오버헤드가 발생하게 됩니다.

### Context Switching이란?

CPU에서 **여러 프로세스를 돌아가면서 작업을 처리**하는데 이 과정을 Context Switching라고 합니다.

구체적으로, 동작 중인 프로세스가 대기를 하면서 해당 프로세스의 **상태(Context)를 보관**하고, 대기하고 있던 다음 순서의 프로세스가 동작하면서 **이전에 보관했던 프로세서의 상태를 복구하는 작업**을 말합니다.

</br >

## 멀티 스레드란?

하나의 응용프로그램을 여러 개의 스레드로 구성하고 **각 스레드로 하여금 하나의 작업을 처리**하도록 하는 것입니다.

윈도우, 리눅스 등 많은 운영체제들이 멀티 프로세싱을 지원하고 있지만, 멀티 스레드를 기본으로 합니다.

</br >

### 멀티 스레드 장점

- 시스템 자원 소모 감소 (자원의 효율성 확대)
  - Context Switching할 때 공유되고 있는 메모리 만큼의 메모리 사용이 줄어들어 자원을 효율적으로 관리할 수 있습니다.
- 시스템 처리량 증가 (처리 비용 감소)
  - 스레드 간 데이터를 주고 받는 것이 간단해지고 시스템 자원 소모가 줄어들게 됩니다.
  - 스레드 사이의 작업량이 작아 Context Switching이 빠릅니다.
- 간단한 통신 방법으로 인한 프로그램 응답 시간 단축
  - 스레드는 프로세스 내의 **Stack영역을 제외한 모든 메모리를 공유하기 때문에 통신의 부담이 적습니다.**

### 멀티스레드 단점

- 다른 프로세스에서 스레드를 제어할 수 없습니다. 프로세스 밖에서 스레드 각각을 제어할 수 없기 때문입니다.
- 멀티 스레드의 경우 자원 공유의 문제가 발생합니다. (동기화 문제)
- 하나의 스레드에 문제가 발생하면 전체 프로세스가 영향을 받습니다.

### 동기화 문제란?

**여러 스레드가 전역 변수를 사용할 경우 발생할 수 있는 충돌을 동기화 문제라고 합니다.** 스케줄링은 운영체제가 자동으로 해주기 않기 때문에 프로그래머가 적절한 기법을 직접 구현해야 하므로 멀티스레드를 사용하려면 신중히 프로그래밍을 해야합니다.

</br >

## 멀티 프로세스 대신 멀티 스레드를 사용하는 이유

멀티 프로세스 대신 멀티 스레드를 사용하는 것의 의미합니다.

쉽게 설명하면, 프로그램을 여러 개 키는 것보다 하나의 프로그램 안에서 여러 작업을 해결하는 것입니다.

</br >

### 여러 프로세스(멀티 프로세스)로 할 수 있는 작업들을 하나의 프로세스에서 여러 스레드로 나눠가면서 하는 이유는?

1. ### 자원의 효율성 증대

프로세스를 생성하여 자원을 할당하는 시스템 콜이 줄어들어 자원을 효율적으로 관리할 수 있습니다. 즉, 프로세스 간의 Context Switching과정에서 캐시 메모리에 대한 데이터를 초기화하므로 오버헤드가 크기 때문입니다.

스레드는 프로세스 내의 메모리를 공유하기 때문에 독립적인 프로세스와 달리 스레드 간 데이터를 주고 받는 것이 간단해지고 시스템 자원 소모가 줄어들게 됩니다.

2. ### 처리 비용 감소 및 응답 시간 단축

프로세스 간의 통신(IPC)보다 스레드 간의 통신의 비용이 적으므로 작업들 간의 통신 부담이 줄어듭니다. 왜냐하면, 스레드는 Stack영역을 제외한 모든 메모리를 공유하기 때문입니다.

프로세스 간의 전환 속도보다 스레드 간의 전환 속도가 빠릅니다. Context Switching시 스레드는 Stack영역을 제외한 모든 메모리를 공유하기 때문입니다.

