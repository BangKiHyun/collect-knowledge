# DB Index

## Index란?

- RDBMS에서 검색도를 높이기 위해 사용하는 기술
- 특정 Table의 컬럼을 색인화(파일로 저장) 하여 검색시 해당 Table의 레코드를 full scan 하는게 아니라 색인화 되어있는 Index파일을 검색하여 검색속도를 빠르게 한다.

</br >

## Index의 목적

- 인덱스의 목적은 해당 RDBMS의 검색 속도를 높이는데 있다.
- select쿼리의 where절이나 join예약어를 사용했을때만 인덱스가 사용되며 **select 쿼리의 검색 속도를 빠르게 하는데 목적을 두고 있다.**
- insert, delete, update 쿼리에는 해당 사항이 없으면 index사용시 느려진다.

</br >

### INSERT

- index split 현상이 발생할 수 있다.
  - Index split: 인덱스의 블록들이 하나에서 두 개로 나누어지는 현상
- 기존 블록에 여유 공간이 없는 상황에서 그 블록에 새로운 데이터가 입력되는 경우 발생
- 이렇게되면 기존 블록의 내용 중 일부를 새 블록에다가 기록한 후 기존 블록에 빈 공간을 만들어 새로운 데이터를 추가하게 됨
- 즉, **새로운 블록을 할당 받고 key를 옮기는 복잡한 작업을 수행**

</br >

### DELETE

- 테이블에서 데이터가 delete될 경우: 데이터가 지워지고, 다른 데이터가 그 공간을 사용 가능
- index에서 데이터가 delete될 경우:  **데이터가 지워지지 않고, 사용 안 됨 표시만 해둠**
- 즉, 테이블에서 데이터가 1만건이 있는 경우, 인덱스에는 2만건의 데이터가 있을 수 있음

</br >

### UPDATE

- 테이블에 update가 발생할 경우 **인덱스에서는 delete가 먼저 발생한 후 새로운 작업의 insert가 발생**
- 즉, **delete와 insert 두 개의 작업이 인덱스에 동시에 일어나 더 큰 부하를 주게 됨**

</br >

## Index 컬럼 기준

### 단일 컬럼으로 인덱스 구성시

- 만약 1개의 컬럼만 인덱스를 걸어야 한다면, 해당 컬럼은 **중복 수치가 가장 낮은 것**으로 잡아야 한다.
  - ex) 중복 수치가 높은 것: 성별, 학년
  - ex) 중복 수치가 낮은 것: 주민등록번호, 계좌번호
- 인덱스로 최대한 효율을 뽑아내려면, **해당 인덱스로 많은 부분을 걸러내야 하기 때문이다.**
- 만약 성별을 인덱스로 잡는다면, 남/녀 중 하나를 선택하기 때문에 인덱스를 통해 50%밖에 걸러내지 못한다.

</br >

### 여러 컬럼으로 인덱스 구성시

- 여러 컬럼으로 인덱스를 잡는다면 중복 수치가 **낮은 :arrow_right: 높은 순**으로 구성하는게 좋다.